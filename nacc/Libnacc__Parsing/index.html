<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Libnacc__Parsing (nacc.Libnacc__Parsing)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">nacc</a> &#x00BB; Libnacc__Parsing</nav><h1>Module <code>Libnacc__Parsing</code></h1><h2 id="error-report"><a href="#error-report" class="anchor"></a>Error report</h2><nav class="toc"><ul><li><a href="#defining-parsers">Defining parsers</a><ul><li><a href="#combinators-and-infix-operators">Combinators and Infix operators</a></li><li><a href="#let-notation">Let notation</a></li><li><a href="#powerfull-combinators">Powerfull Combinators</a></li><li><a href="#utils">Utils</a></li></ul></li></ul></nav></header><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> <span>'a state</span></code></dt><dd><p>Type state</p></dd></dl><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code></dt><dd><p>Type error</p></dd></dl><dl><dt class="spec value" id="val-state"><a href="#val-state" class="anchor"></a><code><span class="keyword">val</span> state : <span><span class="type-var">'a</span> option</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span></code></dt><dd><p>Create a new parser state</p></dd></dl><dl><dt class="spec value" id="val-result_of_state"><a href="#val-result_of_state" class="anchor"></a><code><span class="keyword">val</span> result_of_state : <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p>Get the result</p></dd></dl><dl><dt class="spec value" id="val-state_value"><a href="#val-state_value" class="anchor"></a><code><span class="keyword">val</span> state_value : <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span></code></dt><dd><p>Get the parsed value</p></dd></dl><dl><dt class="spec value" id="val-state_offset"><a href="#val-state_offset" class="anchor"></a><code><span class="keyword">val</span> state_offset : <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> int</code></dt><dd><p>Get the current position of the parser inside the string</p></dd></dl><dl><dt class="spec value" id="val-state_line"><a href="#val-state_line" class="anchor"></a><code><span class="keyword">val</span> state_line : <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> int</code></dt><dd><p>Get the current line position of the parser inside the string</p></dd></dl><dl><dt class="spec value" id="val-state_rest"><a href="#val-state_rest" class="anchor"></a><code><span class="keyword">val</span> state_rest : <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the remaining characters of the string beeing parsed</p></dd></dl><dl><dt class="spec value" id="val-report"><a href="#val-report" class="anchor"></a><code><span class="keyword">val</span> report : <a href="index.html#type-error">error</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Report an error</p></dd></dl><section><header><h2 id="defining-parsers"><a href="#defining-parsers" class="anchor"></a>Defining parsers</h2></header><dl><dt class="spec type" id="type-parser"><a href="#type-parser" class="anchor"></a><code><span class="keyword">type</span> <span>'a parser</span></code></dt><dd><p>Type parser</p></dd></dl><dl><dt class="spec value" id="val-(~~)"><a href="#val-(~~)" class="anchor"></a><code><span class="keyword">val</span> (~~) : <span>(string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Parser constructor</p></dd></dl><dl><dt class="spec value" id="val-pure"><a href="#val-pure" class="anchor"></a><code><span class="keyword">val</span> pure : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Pure parser consuming no character and returning a value of type <code>'a</code>.</p></dd></dl><dl><dt class="spec value" id="val-many"><a href="#val-many" class="anchor"></a><code><span class="keyword">val</span> many : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Parse zero or more times a given pattern</p></dd></dl><dl><dt class="spec value" id="val-some"><a href="#val-some" class="anchor"></a><code><span class="keyword">val</span> some : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> list</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Parse one or more times a given pattern</p></dd></dl><dl><dt class="spec value" id="val-check"><a href="#val-check" class="anchor"></a><code><span class="keyword">val</span> check : <span>(char <span>&#45;&gt;</span> bool)</span> <span>&#45;&gt;</span> <span>char <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Test a predicate on the first character of the input. Resolve to this character if the predicate is verified</p></dd></dl><section><header><h3 id="combinators-and-infix-operators"><a href="#combinators-and-infix-operators" class="anchor"></a>Combinators and Infix operators</h3></header><dl><dt class="spec value" id="val-(&lt;*&gt;)"><a href="#val-(&lt;*&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;*&gt;) : <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Apply</p></dd></dl><dl><dt class="spec value" id="val-(&lt;$&gt;)"><a href="#val-(&lt;$&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;$&gt;) : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Map</p></dd></dl><dl><dt class="spec value" id="val-(*&gt;)"><a href="#val-(*&gt;)" class="anchor"></a><code><span class="keyword">val</span> (*&gt;) : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Apply to the right</p></dd></dl><dl><dt class="spec value" id="val-(&lt;*)"><a href="#val-(&lt;*)" class="anchor"></a><code><span class="keyword">val</span> (&lt;*) : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Apply to the left</p></dd></dl><dl><dt class="spec value" id="val-(&lt;|&gt;)"><a href="#val-(&lt;|&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;|&gt;) : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Alternative</p></dd></dl></section><section><header><h3 id="let-notation"><a href="#let-notation" class="anchor"></a>Let notation</h3></header><dl><dt class="spec value" id="val-let*"><a href="#val-let*" class="anchor"></a><code><span class="keyword">val</span> let* : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span>)</span> <span>&#45;&gt;</span> <span><span class="type-var">'b</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Binding operator using the <code>let*</code> operator. This syntax is similar to Haskel's &quot;do notation&quot; :</p><pre><code class="ml">let tuple_parser =
  let* f1 = floatingpoint in
  let* _ = char ',' in
  let* f2 = floatingpoint in
  pure (f1, f2)</code></pre><p>Even if this operator can be usefull in extreme cases, users are encouraged to use the <a href="index.html#val-(&lt;*&gt;)"><code>(&lt;*&gt;)</code></a> operator instead :</p><pre><code class="ml">let tuple_parser =
  (fun x y -&gt; (x, y)) &lt;$&gt; floatingpoint &lt;*&gt; char ',' *&gt; floatingpoint</code></pre></dd></dl></section><section><header><h3 id="powerfull-combinators"><a href="#powerfull-combinators" class="anchor"></a>Powerfull Combinators</h3></header><aside><p>The following operators are usefull to parse patterns which are left recursive by nature. The typical exemple is arithmetic expressions.</p></aside><dl><dt class="spec value" id="val-chainl"><a href="#val-chainl" class="anchor"></a><code><span class="keyword">val</span> chainl : <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Eliminate left recursion in &quot;left associative&quot; chains. <code>chainl op term</code> is a parser recognizing chains of terms <code>term</code> bound by the operator <code>op</code>. The operator is considered left associative.</p></dd></dl><dl><dt class="spec value" id="val-chainr"><a href="#val-chainr" class="anchor"></a><code><span class="keyword">val</span> chainr : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span></code></dt><dd><p>Eliminate left recursion in &quot;right associative&quot; chains. <code>chainr term op</code> is a parser recognizing chains of terms <code>term</code> bound by the operator <code>op</code>. The operator is considered right associative.</p></dd></dl></section><section><header><h3 id="utils"><a href="#utils" class="anchor"></a>Utils</h3></header><dl><dt class="spec value" id="val-do_parse"><a href="#val-do_parse" class="anchor"></a><code><span class="keyword">val</span> do_parse : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p>Run a parser against a string</p></dd></dl><dl><dt class="spec value" id="val-(--&gt;)"><a href="#val-(--&gt;)" class="anchor"></a><code><span class="keyword">val</span> (--&gt;) : string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span></code></dt><dd><p>Feed a parser with a string (from left to right) This is verry different from <code>do_parse</code> ! No verifications are made on the remaining chars.</p></dd></dl><dl><dt class="spec value" id="val-(&lt;--)"><a href="#val-(&lt;--)" class="anchor"></a><code><span class="keyword">val</span> (&lt;--) : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-state">state</a></span></code></dt><dd><p>Feed a parser with a string (from right to left) <code>p &lt;-- input</code> is <code>input --&gt; p</code>. This function is just for convenience.</p></dd></dl><dl><dt class="spec value" id="val-do_parse_from_file"><a href="#val-do_parse_from_file" class="anchor"></a><code><span class="keyword">val</span> do_parse_from_file : <span><span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <a href="index.html#type-error">error</a>)</span> Stdlib.result</span></code></dt><dd><p>Run a parser against a file</p></dd></dl></section></section></div></body></html>